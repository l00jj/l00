var f=Object.defineProperty;var o=(i,e,t)=>e in i?f(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var n=(i,e,t)=>(o(i,typeof e!="symbol"?e+"":e,t),t);class u{constructor(e,t){n(this,"function");n(this,"isOnce");this.function=e,this.isOnce=t.isOnce?t.isOnce:!1}}class a{constructor(){n(this,"__emittersMap__",new WeakMap);n(this,"__emitters__",new Map)}on(e,t){if(typeof e!="string"||e===""||typeof t!="function")return!1;let s=this.__emitters__.get(e);if(s||(s=new Set,this.__emitters__.set(e,s)),this.__emittersMap__.has(t))return!1;{const r=new u(t,{isOnce:!1});this.__emittersMap__.set(t,r),s.add(r)}return!0}once(e,t){if(this.on(e,t)){const s=this.__emittersMap__.get(t);if(!s)return!1;s.isOnce=!0}else return!1;return!0}off(e,t){const s=this.__emitters__.get(e);if(!s)return!1;const r=this.__emittersMap__.get(t);return r?(this.__emittersMap__.delete(t),s.delete(r),s.size===0&&this.__emitters__.delete(e),!0):!1}offAll(e){const t=this.__emitters__.get(e);return t?(t.clear(),this.__emitters__.delete(e),!0):!1}clearEvents(){return this.__emitters__.clear(),!0}async emit(e,...t){const s=this.__emitters__.get(e);if(!!s)for(let r of s.values()){try{await r.function.apply(void 0,t)}catch(_){console.error(_)}r.isOnce&&this.off(e,r.function)}}}export{a as E};
