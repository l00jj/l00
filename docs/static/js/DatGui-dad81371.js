var f=Object.defineProperty;var p=(l,o,e)=>o in l?f(l,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[o]=e;var a=(l,o,e)=>(p(l,typeof o!="symbol"?o+"":o,e),e);import{N as d,O as v}from"./vendor-ba83ea21.js";import{E as _}from"./EventEmitter-80978bd8.js";const g="dg",n=v.dom;(()=>{let l;for(let o=0;o<document.styleSheets.length;o++){const e=document.styleSheets[o];for(let t=0;o<e.cssRules.length;o++)e.cssRules[t].cssText.startsWith(".dg ul")&&(l=e)}l&&(l.insertRule(".dg ul li.title { position: sticky; top: 0; }"),l.insertRule(".dg.main > ul { overflow: hidden scroll; }"))})();class m extends _{constructor(e={}){super();a(this,"ui");a(this,"viewDom");a(this,"placeDom");a(this,"__resize_handle");const t=Object.getPrototypeOf(e).constructor;if(t===window.HTMLElement||t===window.HTMLDivElement)this.ui=new d({autoPlace:!1}),m.createPlaceContainer(this,e);else{const s=Object.assign({autoPlace:!1},e);this.ui=new d(s)}}static createPlaceContainer(e,t){e.viewDom=t;const s=window.document.createElement("div");n.addClass(s,g),n.addClass(s,d.CLASS_AUTO_PLACE_CONTAINER),s.style.position="absolute";const i=e.ui.domElement;n.addClass(i,d.CLASS_AUTO_PLACE),n.addClass(i,"taller-than-window"),s.appendChild(i),e.placeDom=s,e.atViewAreaResize(),m.onResizeObserve(t,e),m.addResizeHandle(e)}show(){this.viewDom&&this.placeDom&&this.viewDom.appendChild(this.placeDom)}hide(){this.placeDom&&this.placeDom.remove()}atViewAreaResize(){const e=this.viewDom,t=this.ui.domElement,s=t.querySelector("ul"),i=t.querySelector(".close-button");if(e&&s&&i){const c=e.offsetHeight-i.offsetHeight*2;s.style.maxHeight=`${c}px`}}static onResizeObserve(e,t){if(window.ResizeObserver){const s=new ResizeObserver(i=>t.atViewAreaResize());s.observe(e),t.onDestroyed(()=>s.disconnect())}else{const s=()=>t.atViewAreaResize();window.addEventListener("resize",s),t.onDestroyed(()=>window.removeEventListener("resize",s))}}static addResizeHandle(e){const t=e.ui,s={extend(r,w){Object.assign(r,w)}};var i=0;t.__resize_handle=document.createElement("div"),s.extend(t.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});function c(r){return r.preventDefault(),t.width+=i-r.clientX,t.onResize(),i=r.clientX,!1}function u(){n.removeClass(t.__closeButton,d.CLASS_DRAG),n.unbind(window,"mousemove",c),n.unbind(window,"mouseup",u)}function h(r){return r.preventDefault(),i=r.clientX,n.addClass(t.__closeButton,d.CLASS_DRAG),n.bind(window,"mousemove",c),n.bind(window,"mouseup",u),!1}n.bind(t.__resize_handle,"mousedown",h),n.bind(t.__closeButton,"mousedown",h),t.domElement.insertBefore(t.__resize_handle,t.domElement.firstElementChild)}onDestroyed(e){return this.once("destroyed",e)}destroy(){var e;(e=this.ui)==null||e.destroy(),this.emit("destroyed")}}export{m as D};
